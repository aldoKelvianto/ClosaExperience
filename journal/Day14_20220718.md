Xcode cloud workflow

---

Pull request workflow

Runs for every pull requests
Analyze, test, and archive app
Notify the developer team
Deliver app to tester

Product -> Xcode cloud -> Manage workflows -> Products -> click + -> select app

Type: Every change to pull request
Source branch: Any branch
Target branch: Main 
Auto-cancel builds

## Start condition

Start condition types:
- Every change to a branch: Any new commit
- Every change to a tag: For release/debug tag
- On a schedule: Cron or long running UI test

## Environment

Environment:
- Xcode or macOS version

You can build incrementally in Xcode.
You can build incrementally in Xcode cloud, too!

Clean build is also supported.
Do that by ticking "Clean" option

For pull request, don't do clean build.

Xcode cloud has an API too!
You can access your data, configure workflows, kick off builds, run custom scripts through an API. Not just Web/Xcode UI.

Also, in the environment, you can mark some variable as "secret".
Variable such as key or password will be protected by Apple.

## Actions

Build, analyze, test, archive

Archive
Xcode cloud manages provisioning profile or identities or app signing.

Test action
Stable, reliable, reproducible environment
Free up your local environment
Run automatically

Analyze action
Require to pass or not

Build action
Secondary build configuration, scheme, frameworks compiles successfuly.

## Post actions

Sending notifications
Deploying with TestFlight

Build successes
All build successes, only fixes, don't notify

Build failures
All build failures, only breaks, don't notify

Notify
Build success/fail: all

Notify to Slack channel (i.e #ci-builds) or Email

TestFlight post-actions

Internal testing only
Recommended branches: Pull requests, development branches
Eligible recipients: Internal testers
Clean builds: Not required
Beta app review: X
App store eligible: X

External testing and App Store
Recommended branches: Candidate, release branch
Eligible recipients: Internal and external tersters
Clean builds: Required
Beta app review: ✅
App store eligible: ✅

TestFlight internal testing

Add an archive section
Set archive deployment to TestFlight (internal only) 
Add a TestFlight internal testing post-action

To publish your IPA to TestFlight, you have to:
1. Create Archive action under actions
2. Create TestFlight Internal Testing post-action under Post-Actions

When you select (2), the (1) should be auto-added


