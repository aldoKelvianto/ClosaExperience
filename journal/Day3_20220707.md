# Day 3

Create a new iOS project: WeatheringWithSwift

![Another Makoto Shinkai-sensei masterpiece](images/d3_weathering.jpg)

Configuration:
- Core data
- SwiftUI
- Test

Today, I'm overwhelmed by the number of file that generated by XCode. There are too many of them!
But, let's learn it one by one. As promised, today is more hands-on compared to yesterday.
I'll start from.. The tests! As expected from Java programmers ðŸ˜…

XCode generate two test folder:

1. WeatheringWithSwiftTests -> For unit tests
2. WeatheringWithSwiftUITests -> For UI tests

Both classes in the folder inherit `XCTestCase`, regardless it's for unit or UI tests.

## UI Test Classes

The test will launch an iOS emulator and the app itself.

1. WeatheringWithSwiftUITestsLaunchTests

This class will launch the app multiple times and take a screenshot of the app.
Why multiple times? Because it will launch the app according to the UI configuration.

```swift
override class var runsForEachTargetApplicationUIConfiguration: Bool {
    true
}
```

So, where is the UI configuration?

1. Click "Show The Project Navigator" button
2. Click "Build Settings" menu
3. Search for Info.plist Values
4. Modify the Supported Interface Orientations (iPhone)
5. Double click the Debug key
6. Add/Remove the values

```
UIInterfaceOrientationPortrait
UIInterfaceOrientationLandscapeLeft
UIInterfaceOrientationLandscapeRight
```

If you remove landscape left & right, the app only launch in portrait mode.

Tips: Get a good mouse, you gonna need it for GUI interactions in XCode.

2. WeatheringWithSwiftUITests

The `testExample` just launch the app and do nothing.
You're expected to write assertions in this block.

The `testLaunchPerformance` will launch the app multiple times to measure the app launch time.
In my case it launch the app 6 times and takes the average launch time (0,968 seconds)
The whole test duration is 1m 18s.

```swift
func testLaunchPerformance() throws {
    if #available(macOS 10.15, iOS 13.0, tvOS 13.0, watchOS 7.0, *) {
        // This measures how long it takes to launch your application.
        measure(metrics: [XCTApplicationLaunchMetric()]) {
            XCUIApplication().launch()
        }
    }
}
```

Where does the 6 times comes from? I don't know. As you can see from the code, there's no code that instruct the app to launch 6 times. Maybe it's just the default behavior.

## Unit Test Class

Same thing, the test will launch an iOS emulator and the app itself.
It's rather unexpected. In Android, a unit test can be executed without running an emulator

1. WeatheringWithSwiftTests

The `testExample` do nothing, so I add an assertions to make it interesting.

```swift
func testExample() throws {
    // This is an example of a functional test case.
    // Use XCTAssert and related functions to verify your tests produce the correct results.
    // Any test you write for XCTest can be annotated as throws and async.
    // Mark your test throws to produce an unexpected failure when your test encounters an uncaught error.
    // Mark your test async to allow awaiting for asynchronous code to complete. Check the results with assertions afterwards.
    XCTAssertEqual(1, 1, "One is equal to one")
}
```

You can change the value to 2, i.e

```swift
XCTAssertEqual(1, 2, "One is equal to one")
```

To ensure the assertion does fail.

The `testPerformanceExample` demonstrates that you can measure the time a function is executed.

```swift
func testPerformanceExample() throws {
    // This is an example of a performance test case.
    self.measure {
        // Put the code you want to measure the time of here.
        XCTAssertEqual(1, 1, "One is equal to one")
    }
}
```

I find it interesting that the test Framework has a built-in measure function for this. In Java, you have to write your own code.

```java
long start = System.currentTimeMillis();
// ...
long finish = System.currentTimeMillis();
long timeElapsed = finish - start;
```

Thankfuly Kotlin has built-in function, `measureTimeMillis`, for measuring the execution time.

I'd like to write more but, the times up!
Let's continue it tomorrow.
